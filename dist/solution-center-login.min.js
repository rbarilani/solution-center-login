/*!
 * solution-center-login
 * https://github.com/zalando/solution-center-login
 * License: MIT
 */
angular.module("sc-authentication",["ngStorage","ngCookies","angular-jwt"]).factory("solutionCenterAuth",["$q","$localStorage","$cookies","environments","$location","$http","jwtHelper",function(n,t,e,o,r,u,i){"use strict";function s(n,e){var o=f();return o||a(n,e),t.sc_token=o,t.sc_user=k(o),o}function a(n,t){r.url(o.getLoginUrl(n)+"?redirect="+t)}function l(n){t.sc_token=null,t.sc_user=null,r.url(o.getLogoutUrl(n))}function c(){return t.sc_token||e.get(v)}function g(){return t.sc_user}function f(){var n=c();return d(n).then(function(){return n},function(t){return 304===t.status?n:409===t.status?t.data:null})}function d(t){return null===t?n.reject("null token"):u.get(o.getTokensAPI(),t)}function k(n){return i.decodeToken(n)}var v="SC_TOKEN";return{authenticate:s,redirectToLogin:a,getToken:c,logout:l,getUser:g}}]),angular.module("sc-authentication").factory("environments",[function(){function n(n){return r[n].url}function t(t){return n(t)+"/#/login"}function e(t){return n(t)+"/#/logout"}function o(n){return r[n].tokenservice+"/tokens"}var r={PRODUCTION:{url:"solutions.zalando.com",tokenservice:"https://token-management.norris.zalan.do"},INTEGRATION:{url:"usf-integration.norris.zalan.do",tokenservice:"https://tm-integration.norris.zalan.do"},STAGING:{url:"usf-stage.norris.zalan.do",tokenservice:"https://tm-stage.norris.zalan.do"},DEVELOPMENT:{url:"usf-dev.norris.zalan.do",tokenservice:"https://tm-dev-ext.norris.zalan.do"},LOCAL:{url:"localhost",tokenservice:"https://tm-dev-ext.norris.zalan.do"}};return{getLoginUrl:t,getLogoutUrl:e,getTokensAPI:o}}]);